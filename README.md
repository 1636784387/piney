# ğŸ¿ Piney (å°å…„è®¸)

<div align="center">
  <img src="frontend/static/logo.png" alt="Piney" width="120" />
</div>

*å…¶å®æ‡’å¾—å†™ï¼Œå‡‘åˆçœ‹ä¸€ä¸‹*

> **SillyTavernè§’è‰²å¡å·¥ä½œç«™**

Piney æ˜¯ä¸€ä¸ªç°ä»£åŒ–çš„è§’è‰²å¡ç®¡ç†ç³»ç»Ÿï¼Œä¸“ä¸º SillyTavern ç”¨æˆ·å’Œåˆ›ä½œè€…è®¾è®¡ã€‚å®ƒä¸ä»…ä»…æ˜¯ä¸€ä¸ªç®¡ç†å™¨ï¼Œæ›´æ˜¯ä¸€ä¸ªé›†åˆ›ä½œã€ç¼–è¾‘ã€ç»Ÿè®¡ã€å±•ç¤ºäºä¸€ä½“çš„â€œå¡ç‰‡ç®¡å®¶â€ã€‚

## âœ¨ æ ¸å¿ƒç‰¹æ€§

- **ğŸ“š è§’è‰²å¡æ·±å±‚ç®¡ç†**ï¼šæ”¯æŒ V2/V3 è§„èŒƒï¼Œæ·±åº¦è§£æ Character Card æ•°æ®ï¼ˆåŒ…æ‹¬ World Infoã€Regex Scriptsï¼‰ï¼ŒåŒæ—¶æ”¯æŒæ–°å»ºè§’è‰²å¡ï¼ŒAI è¾…åŠ©ç”Ÿæˆå†…å®¹ç­‰ã€‚
- **ğŸ•µï¸â€â™€ï¸ èŠå¤©è®°å½•æŸ¥çœ‹**ï¼šå¯¼å…¥ SillyTavern èŠå¤©è®°å½•ï¼ŒæŸ¥çœ‹ Token æ¶ˆè€—ã€èŠå¤©è½®æ•°ï¼Œç”šè‡³å¯ä»¥å›æ”¾èŠå¤©è¿‡ç¨‹ã€‚
- **ğŸŒ ä¸–ç•Œä¹¦ä¸å°å‰§åœº**ï¼šç‹¬ç«‹çš„ World Info ç¼–è¾‘å™¨ï¼Œä»¥åŠâ€œå°å‰§åœºâ€å­˜å‚¨åŠŸèƒ½ï¼ˆTheatersï¼‰ã€‚
- **ğŸ¨ æ™ºèƒ½å›¾åº“**ï¼šç®¡ç†è§’è‰²ç›¸å…³çš„æ’å›¾ã€ç«‹ç»˜ã€‚æ”¯æŒè‡ªåŠ¨è¯»å– ComfyUI/NovelAI å…ƒæ•°æ®ï¼ŒAI æ ‡è®°ä¸æˆæƒç®¡ç†ã€‚
- **ğŸ–Œ å‰ç«¯ç¾åŒ–**ï¼šä¸€é”®ç”Ÿæˆä¸–ç•Œä¹¦æ¡ç›®ã€æ­£åˆ™ã€æ ·å¼ï¼Œå¯ä»¥ä¸€é”®æ’å…¥åˆ°è§’è‰²å¡ã€‚
- **ğŸ’¾ æ•°æ®å¤‡ä»½**ï¼šä¸€é”®å¯¼å‡º/å¯¼å…¥å¤‡ä»½ã€‚
- **ğŸŒ å…¶ä»–åŠŸèƒ½**ï¼šä¸€äº›å°åŠŸèƒ½ï¼Œä¾‹å¦‚æ¯æ¬¡è§’è‰²å¡æ¨èã€æŠ½å¡ã€ä¸–ç•Œä¹¦æ¡ç›®å¯¼å…¥åˆ°å…¨å±€ä¸–ç•Œä¹¦ã€ä»å…¨å±€ä¸–ç•Œä¹¦ä¸­å¯¼å…¥æ¡ç›®ã€å°çš®åŒ»ç”Ÿæ£€æµ‹è§’è‰²å¡â€è´¨é‡â€œç­‰ï¼Œç­‰ä½ å‘ç°ã€‚

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

æœ¬é¡¹ç›®é‡‡ç”¨å‰åç«¯åˆ†ç¦»çš„ç°ä»£åŒ–æ¶æ„ï¼š

- **åç«¯**: [Rust](https://www.rust-lang.org/) + [Axum](https://github.com/tokio-rs/axum)
  - æ•°æ®åº“: SQLite + [SeaORM](https://www.sea-ql.org/SeaORM/) (Async)
  - è¿ç§»ç®¡ç†: SeaORM Migration
- **å‰ç«¯**: [SvelteKit](https://kit.svelte.dev/) (Svelte 5)
  - UI åº“: [Shadcn-Svelte](https://next.shadcn-svelte.com/) + TailwindCSS
  - å›¾æ ‡: Lucide Icons
- **éƒ¨ç½²**: Docker / Docker Compose

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å‰ç½®è¦æ±‚
- Rust (æœ€æ–°ç¨³å®šç‰ˆ)
- Node.js (v18+)
- pnpm (æ¨è) æˆ– npm

### æœ¬åœ°å¼€å‘

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/andclear/piney.git
   cd piney
   ```

2. **åç«¯è®¾ç½®**
   ```bash
   # å®‰è£…ä¾èµ–å¹¶è¿è¡Œï¼ˆä¼šè‡ªåŠ¨åˆ›å»ºæ•°æ®åº“å¹¶æ‰§è¡Œè¿ç§»ï¼‰
   cargo run
   ```
   åç«¯é»˜è®¤è¿è¡Œåœ¨ `http://127.0.0.1:9696`ã€‚

3. **å‰ç«¯è®¾ç½®**
   ```bash
   cd frontend
   npm install
   npm run dev
   ```
   å‰ç«¯é»˜è®¤è¿è¡Œåœ¨ `http://127.0.0.1:5173`ã€‚

4. **è®¿é—®**
   æ‰“å¼€æµè§ˆå™¨è®¿é—®å‰ç«¯åœ°å€ï¼Œé¦–æ¬¡ä½¿ç”¨ä¼šè¦æ±‚æ³¨å†Œã€‚åæœŸå¿˜äº†å¯†ç å¯ä»¥æŸ¥çœ‹ï¼š`data/config.yml`ï¼ˆé¦–æ¬¡è¿è¡Œåç”Ÿæˆï¼‰ã€‚

## ğŸ³ Docker Compose éƒ¨ç½²

åˆ›å»ºæ–‡ä»¶å¤¹

```
mkdir piney && cd piney
```

åˆ›å»º docker-composeæ–‡ä»¶

```
nano docker-compose.yml
```

å¤åˆ¶å¹¶ç²˜è´´ä¸‹æ–¹ä»£ç 

```
services:
  piney:
    image: ghcr.io/andclear/piney:latest
    container_name: piney
    restart: unless-stopped
    ports:
      - "9696:9696"
    volumes:
      - ./data:/app/data
    environment:
      - RUN_MODE=server
      - PORT=9696
    healthcheck:
      test: [ "CMD", "curl", "-f", "http://localhost:9696/api/health" ]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 10s

```

æŒ‰ `Ctrl+O`ï¼ˆå­—æ¯æ¬§ï¼‰ä¿å­˜ï¼ŒæŒ‰`Ctrl+X`é€€å‡º

ç„¶åæ‰§è¡Œï¼š

```
docker compose up -d
```

## Zeaburéƒ¨ç½²æ–¹æ³•ï¼š

1. æ–°å»ºæœåŠ¡

![alt text](doc/1.png)

2. é€‰æ‹© Dockerå®¹å™¨é•œåƒ

![alt text](doc/2.png)

3. å¡«å†™é•œåƒä¿¡æ¯ã€ç«¯å£

![alt text](doc/3.png)

4. æ·»åŠ æ•°æ®å·

![alt text](doc/4.png)

å®Œæˆï¼Œä¹‹åå¯ä»¥è‡ªå·±åˆ›å»ºè®¿é—®é“¾æ¥ã€‚

é•œåƒå¡«å†™ï¼š

```
ghcr.io/andclear/piney:latest
```

ç«¯å£ï¼š9696

æ•°æ®å·ï¼š
- å·¦è¾¹ï¼šdata
- å³è¾¹ï¼š/app/data


## ğŸ“‚ æ•°æ®åº“è¿ç§»

é¡¹ç›®ä½¿ç”¨ SeaORM ç®¡ç†æ•°æ®åº“ç»“æ„ã€‚

- **å¼€å‘ç¯å¢ƒè‡ªåŠ¨è¿ç§»**ï¼šæ¯æ¬¡å¯åŠ¨ `cargo run` æ—¶ï¼Œç¨‹åºä¼šè‡ªåŠ¨æ£€æµ‹å¹¶æœªåº”ç”¨çš„è¿ç§»è„šæœ¬å¹¶æ‰§è¡Œã€‚
- **ç»“æ„åˆå¹¶**ï¼šä¸»è¦è¿ç§»è„šæœ¬å·²åˆå¹¶ä¸º `migration/src/m000001_v1_init.rs`ï¼Œæ”¯æŒä»æ—§ï¼ˆå†…æµ‹ï¼‰ç‰ˆæœ¬è‡ªåŠ¨å¹³æ»‘å‡çº§ã€‚

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue æˆ– Pull Requestï¼

## ğŸ“„ è®¸å¯è¯

CC BY-NC-SA 4.0